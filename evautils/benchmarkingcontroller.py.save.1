#!/usr/bin/python

import os
import gzip
import re

def narrowPeakToBed(narrowPeaksFile, regionSize, bedfile){
	fp_np = gzip.open(narrowPeaksFile)
	fp_bed = open(bedfile, 'w')
	for line in fp_np:
        	match = re.match("(\S+)\s+(\d+)\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+\S+\s+(\d+)\s*$", line)
        	if match:
                	chrom = match.group(1)
                	chromStart = int(match.group(2))
                	chromSummitOffset = int(match.group(3))
                	regionStart = chromStart + chromSummitOffset - int(regionSize/2)
                	regionEnd = regionStart + regionSize
                	fp_bed.write("" + chrom + "\t" + str(regionStart) + "\t" + str(regionEnd))

	cmd='zcat ' + narrowPeaksFile + ' | /users/eprakash/projects/benchmarking/scripts/narrowpeaks_to_bed.py ' + seqlen + ' >  ' + bedfile
	os.system(cmd)
